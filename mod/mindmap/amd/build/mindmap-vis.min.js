define("mod_mindmap/mindmap-vis",["jquery","mod_mindmap/mindmap"],(function($,Mindmap){return{Init:function(mindmapid,locked,lang,strings,mindmapmode,mindmapindividualid){var mindmapdata;$.ajax({async:!1,url:"mindmapdata.php?id="+(mindmapindividualid||mindmapid)+(mindmapmode?"&mindmapmode="+mindmapmode:""),success:function(result){mindmapdata=result}});var local_locales={custom:{edit:strings.visjsedit,del:strings.visjsdel,back:strings.visjsback,addNode:strings.visjsaddnode,addEdge:strings.visjsaddedge,editNode:strings.visjseditnode,editEdge:strings.visjseditedge,addDescription:strings.visjsadddescription,edgeDescription:strings.visjsedgedescription,editEdgeDescription:strings.visjseditedgedescription,createEdgeError:strings.visjscreateedgeerror,deleteClusterError:strings.visjsdeleteclustererror,editClusterError:strings.visjseditclustererror}},network=null,inputValue=mindmapdata;if(inputValue.length>0)var inputData=JSON.parse(inputValue),data={nodes:function(data){var networkNodes=[];return data.forEach((function(elem,index,array){networkNodes.push({id:elem.id,label:elem.label,shape:elem.hasOwnProperty("shape")?elem.shape:"box",x:elem.x,y:elem.y,font:{color:elem.hasOwnProperty("font")?elem.font.color:"#343434"},color:{background:elem.hasOwnProperty("color")?elem.color.background:"#97c1fc"},widthConstraint:{maximum:300},margin:10})})),new vis.DataSet(networkNodes)}(inputData),edges:function(data){var networkEdges=[];return data.forEach((function(node){node.connections.forEach((function(connId,cIndex,conns){networkEdges.push({from:node.id,to:connId,width:2});var cNode=function(data,id){for(var n=0;n<data.length;n++)if(data[n].id==id)return data[n];throw"Can not find id '"+id+"' in data"}(data,connId),elementConnections=cNode.connections,duplicateIndex=elementConnections.filter((function(connection){return connection==node.id}))[0];-1!=duplicateIndex&&elementConnections.splice(duplicateIndex,1)}))})),new vis.DataSet(networkEdges)}(inputData)};else data={nodes:[{id:"moodle",label:"Moodle",x:400,y:370,font:{color:"#ffffff",size:18},color:{background:"#ff0000"},widthConstraint:{maximum:300},margin:10,borderWidth:1,shape:"box",labelHighlightBold:!1}],edges:[]};function clearPopUp(){document.getElementById("savebutton").onclick=null,document.getElementById("cancelbutton").onclick=null,document.getElementById("network-popup").style.display="none"}function cancelEdit(callback){clearPopUp(),callback(null)}function saveData(data,callback){data.id=document.getElementById("node-id").value,data.label=document.getElementById("node-label").value,data.shape=document.getElementById("node-shape").value,data.font.color=document.getElementById("node-font-color").value,data.color.background=document.getElementById("node-color-background").value,clearPopUp(),callback(data)}function addConnections(elem,index){elem.connections=network.getConnectedNodes(elem.id)}function addNodeProperties(elem,index){elem.label=network.body.nodes[elem.id].options.label,network.body.nodes[elem.id].options.hasOwnProperty("shape")&&(elem.shape=network.body.nodes[elem.id].options.shape),network.body.nodes[elem.id].options.font.hasOwnProperty("color")&&(elem.font={},elem.font.color=network.body.nodes[elem.id].options.font.color),network.body.nodes[elem.id].options.color.hasOwnProperty("background")&&(elem.color={},elem.color.background=network.body.nodes[elem.id].options.color.background)}function exportNetwork(){var obj,nodes=(obj=network.getPositions(),Object.keys(obj).map((function(key){return obj[key].id=key,obj[key]})));nodes.forEach(addNodeProperties),nodes.forEach(addConnections);var exportValue=JSON.stringify(nodes,void 0,2);(new Mindmap).mindmapsubmit(mindmapindividualid||mindmapid,exportValue,mindmapmode)}var container=document.querySelector(".network"),options={};0==locked?(options={manipulation:{initiallyActive:!0,addNode:function(data,callback){document.getElementById("operation").innerHTML=strings.visjsaddnode,document.getElementById("node-id").value=data.id,document.getElementById("node-label").value="",document.getElementById("node-font-color").value="#343434",document.getElementById("node-color-background").value="#97c1fc",document.getElementById("node-shape").value="box";var newData={id:document.getElementById("node-id").value,x:data.x,y:data.y,label:document.getElementById("node-label").value,shape:document.getElementById("node-shape").value,font:{color:document.getElementById("node-font-color").value},color:{background:document.getElementById("node-color-background").value}};document.getElementById("savebutton").onclick=saveData.bind(this,newData,callback),document.getElementById("cancelbutton").onclick=clearPopUp.bind(),document.getElementById("network-popup").style.display="block"},editNode:function(data,callback){document.getElementById("operation").innerHTML=strings.visjseditnode,document.getElementById("node-id").value=data.id,document.getElementById("node-label").value=data.label,document.getElementById("node-font-color").value=data.font.hasOwnProperty("color")?data.font.color:"#343434",document.getElementById("node-color-background").value=data.color.hasOwnProperty("background")?data.color.background:"#97c1fc",document.getElementById("node-shape").value=data.hasOwnProperty("shape")?data.shape:"box",document.getElementById("savebutton").onclick=saveData.bind(this,data,callback),document.getElementById("cancelbutton").onclick=cancelEdit.bind(this,callback),document.getElementById("network-popup").style.display="block"},addEdge:function(data,callback){data.from==data.to?1==confirm("Do you want to connect the node to itself?")&&callback(data):callback(data)}},physics:{enabled:!1},edges:{physics:!1,dashes:!1,smooth:{enabled:!1},width:2},nodes:{borderWidth:1,shape:"box",widthConstraint:{maximum:300},margin:10,font:{size:18},labelHighlightBold:!1}},$("#export_button").on("click",(function(){exportNetwork()}))):options={physics:{enabled:!1},edges:{physics:!1,dashes:!1,smooth:{enabled:!1},width:2},nodes:{borderWidth:1,shape:"box",widthConstraint:{maximum:300},margin:10,font:{size:18},labelHighlightBold:!1}},options.locales=local_locales,options.locale="custom",(network=new vis.Network(container,data,options)).on("zoom",(function(){pos=[],pos=network.getViewPosition(),network.getScale()<=.49&&network.moveTo({position:{x:pos.x,y:pos.y},scale:.49}),network.getScale()>=5.49&&network.moveTo({position:{x:pos.x,y:pos.y},scale:5.49})})),$(".resetzoom").on("click",(function(){network.fit()})),0==locked&&(network.on("doubleClick",(function(params){params.edges.length>=0&&params.nodes.length>0?network.editNode():params.edges.length>0&&0==params.nodes.length?network.editEdgeMode():0==params.edges.length&&0==params.nodes.length&&network.addEdgeMode()})),$("html").keyup((function(e){"Insert"==e.key&&network.addNodeMode(),"Delete"==e.key&&network.deleteSelected()})))}}}));

//# sourceMappingURL=mindmap-vis.min.js.map