var defaults,main;window.wheelzoom=(defaults={zoom:.1,maxZoom:!1,initialZoom:1,initialX:.5,initialY:.5},main=function(img,options){if(img&&img.nodeName&&"IMG"===img.nodeName){var zoom,width,height,bgWidth,bgHeight,bgPosX,bgPosY,previousEvent,transparentSpaceFiller,settings={},destroy=function(originalProperties){img.removeEventListener("wheelzoom.destroy",destroy),img.removeEventListener("wheelzoom.reset",reset),img.removeEventListener("load",load),img.removeEventListener("mouseup",removeDrag),img.removeEventListener("mousemove",drag),img.removeEventListener("mousedown",draggable),img.removeEventListener("wheel",onwheel),img.style.backgroundImage=originalProperties.backgroundImage,img.style.backgroundRepeat=originalProperties.backgroundRepeat,img.src=originalProperties.src}.bind(null,{backgroundImage:img.style.backgroundImage,backgroundRepeat:img.style.backgroundRepeat,src:img.src});img.addEventListener("wheelzoom.destroy",destroy),options=options||{},Object.keys(defaults).forEach((function(key){settings[key]=void 0!==options[key]?options[key]:defaults[key]})),img.complete&&(load(),new ResizeObserver((function(){var computedStyle=window.getComputedStyle(img,null);width=parseInt(computedStyle.width,10),height=parseInt(computedStyle.height,10),bgHeight=height*zoom,bgPosX=.5*width-(bgWidth=width*zoom)*settings.initialX,bgPosY=.5*height-bgHeight*settings.initialY,img.style.backgroundSize=bgWidth+"px "+bgHeight+"px",img.style.backgroundPosition=bgPosX+"px "+bgPosY+"px"})).observe(img)),img.addEventListener("load",load)}function triggerUpdateDataEvent(){var x=((.5*width-bgPosX)/bgWidth*100).toFixed(1),y=((.5*height-bgPosY)/bgHeight*100).toFixed(1),currentZoom=(bgWidth/width*100).toFixed(0);img.dispatchEvent(new CustomEvent("wheelzoom.data",{bubbles:!0,detail:{x:x,y:y,zoom:currentZoom}}))}function updateBgStyle(){bgPosX>0?bgPosX=0:bgPosX<width-bgWidth&&(bgPosX=width-bgWidth),bgPosY>0?bgPosY=0:bgPosY<height-bgHeight&&(bgPosY=height-bgHeight),img.style.backgroundSize=bgWidth+"px "+bgHeight+"px",img.style.backgroundPosition=bgPosX+"px "+bgPosY+"px",triggerUpdateDataEvent()}function reset(){bgWidth=width,bgHeight=height,bgPosX=bgPosY=0,updateBgStyle()}function onwheel(e){var deltaY=0;e.preventDefault(),e.deltaY?deltaY=e.deltaY:e.wheelDelta&&(deltaY=-e.wheelDelta);var rect=img.getBoundingClientRect(),offsetX=e.pageX-rect.left-window.pageXOffset,offsetY=e.pageY-rect.top-window.pageYOffset,bgRatioX=(offsetX-bgPosX)/bgWidth,bgRatioY=(offsetY-bgPosY)/bgHeight;deltaY<0?(bgWidth+=bgWidth*settings.zoom,bgHeight+=bgHeight*settings.zoom):(bgWidth-=bgWidth*settings.zoom,bgHeight-=bgHeight*settings.zoom),settings.maxZoom&&(bgWidth=Math.min(width*settings.maxZoom,bgWidth),bgHeight=Math.min(height*settings.maxZoom,bgHeight)),bgPosX=offsetX-bgWidth*bgRatioX,bgPosY=offsetY-bgHeight*bgRatioY,bgWidth<=width||bgHeight<=height?reset():updateBgStyle()}function drag(e){e.preventDefault(),bgPosX+=e.pageX-previousEvent.pageX,bgPosY+=e.pageY-previousEvent.pageY,previousEvent=e,updateBgStyle()}function removeDrag(){document.removeEventListener("mouseup",removeDrag),document.removeEventListener("mousemove",drag)}function draggable(e){e.preventDefault(),previousEvent=e,document.addEventListener("mousemove",drag),document.addEventListener("mouseup",removeDrag)}function load(){if(zoom=settings.initialZoom,settings.initialZoom<1?zoom=1:settings.initialZoom>20&&(zoom=20),img.src!==transparentSpaceFiller){var computedStyle=window.getComputedStyle(img,null);width=parseInt(computedStyle.width,10),height=parseInt(computedStyle.height,10),bgHeight=height*zoom,bgPosX=.5*width-(bgWidth=width*zoom)*settings.initialX,bgPosY=.5*height-bgHeight*settings.initialY,function(img){img.style.backgroundRepeat="no-repeat",img.style.backgroundImage='url("'+img.src+'")',transparentSpaceFiller="data:image/svg+xml;base64,"+window.btoa('<svg xmlns="http://www.w3.org/2000/svg" width="'+img.naturalWidth+'" height="'+img.naturalHeight+'"></svg>'),img.src=transparentSpaceFiller}(img),img.style.backgroundSize=bgWidth+"px "+bgHeight+"px",img.style.backgroundPosition=bgPosX+"px "+bgPosY+"px",triggerUpdateDataEvent(),img.addEventListener("wheelzoom.reset",reset),img.addEventListener("wheel",onwheel),img.addEventListener("mousedown",draggable)}}},"function"!=typeof window.btoa?function(elements){return elements}:function(elements,options){return elements&&elements.length?Array.prototype.forEach.call(elements,(function(node){main(node,options)})):elements&&elements.nodeName&&main(elements,options),elements});

//# sourceMappingURL=wheelzoom.min.js.map