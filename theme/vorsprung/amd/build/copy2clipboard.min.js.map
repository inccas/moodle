{"version":3,"file":"copy2clipboard.min.js","sources":["../src/copy2clipboard.js"],"sourcesContent":["import $ from 'jquery';\nimport 'theme_boost_vorsprung/bootstrap/tooltip';\nimport ClipboardJS from 'theme_vorsprung/external/clipboard';\n\nexport const init = () => {\n  $(function(){\n    // TODOJH: Remove\n    // alert('copy2clipboard.js');\n    // console.log('Entered copy2clipboard.js');\n    $(\"a.copytocb[data-toggle='popover'],a.copytocb[data-toggle='collapse']\").each(function () {\n      var btnHtml = '<i class=\"fa fa-clipboard cb-tooltip pl-1\" aria-hidden=\"true\" title=\"Copy to clipboard\"></i>';\n      // Insert after HTML-link not inside link\n      $(this).after(btnHtml);\n    });\n\n    $(\".copytocb:not([data-toggle])\").each(function () {\n      var btnHtml = $('<i class=\"fa fa-clipboard cb-tooltip\" aria-hidden=\"true\" title=\"Copy to clipboard\"></i>');\n      if($(this).prop(\"tagName\") === 'IMG') {\n        btnHtml.addClass('pt-2 d-block');\n        $(this).after(btnHtml);\n      } else {\n        btnHtml.addClass('pl-1 btn-copytocb');\n        $(this).append(btnHtml);\n      }\n    });\n\n    $('.cb-tooltip')\n            .tooltip()\n            .on('mouseleave', function () {\n              $(this).tooltip('hide');\n            });\n\n    var clipboard = new ClipboardJS('.fa-clipboard', {\n      text: function (trigger) {\n        let t = '';\n        let pre = null;\n\n        // Check data attribute on trigger\n        let target = $(trigger).data('copy-target');\n        if(typeof(target) !== \"undefined\") {\n          target = $('#'+target);\n          if(typeof(target) !== \"undefined\") {\n            return $.trim(target.text());\n          }\n        }\n\n        // Check for attribute href\n        target = $(trigger).prev().attr(\"href\");\n        if(typeof(target) !== \"undefined\") {\n          pre = $(target + '> pre:first');\n          if(pre.get(0)) {\n            t = getContent(pre);\n          } else {\n            t = $.trim($(target).text());\n          }\n          // console.log('href: ' + t);\n          if(t !== \"\") {\n            return t;\n          }\n        }\n\n        // popover\n        t = $(trigger).prev().attr(\"data-content\");\n        if(typeof(t) !== \"undefined\" && t !== \"\") {\n          // console.log('data-content: ' + t);\n          return t;\n        }\n\n        // Take inner html of\n        let self;\n        if($(trigger).prev().prop(\"tagName\") === 'IMG') {\n          self = $(trigger).prev();\n        } else {\n          self = $(trigger).parent();\n        }\n        if(self.get(0)) {\n          let $cloned = self\n                  .clone()\n                  .find(\"i.btn-copytocb\")\n                  .remove()\n                  .end()\n                  .removeClass('copytocb')\n                  .filter('[class=\"\"]')\n                  .removeAttr('class');\n          if($cloned.prop(\"tagName\") === 'IMG') {\n            let src = $cloned.attr('src');\n            $cloned.attr('src', getStaticImgTag(src));\n          }\n          t = $cloned.prop('outerHTML');\n          // console.log('Cloned: ' + t);\n          if(t !== \"\") {\n            return t;\n          }\n        }\n        return \"Target to copy not found\";\n      }\n    });\n\n    clipboard.on('success', function (e) {\n      $(e.trigger)\n              .attr('title', 'Copied!')\n              .tooltip('_fixTitle')\n              .tooltip('show')\n              .attr('title', 'Copy to clipboard')\n              .tooltip('_fixTitle');\n\n      e.clearSelection();\n    });\n\n    clipboard.on('error', function (e) {\n      var modifierKey = /mac/i.test(navigator.userAgent) ? '\\u2318' : 'Ctrl-';\n      var fallbackMsg = 'Press ' + modifierKey + 'C to copy';\n\n      $(e.trigger)\n              .attr('title', fallbackMsg)\n              .tooltip('_fixTitle')\n              .tooltip('show')\n              .attr('title', 'Copy to clipboard')\n              .tooltip('_fixTitle');\n    });\n\n    /**\n     *\n     * @param {Object} pre Element to get content from\n     * @returns {string|*} Inner HTML as string\n     */\n    function getContent(pre = null){\n      let t = \"Target to copy not found\";\n      if (pre === null) {\n        return t;\n      }\n      let elem = pre.parent('.collapse');\n      let isCollapsed = false;\n      if(elem.get(0)) {\n        if(! elem.hasClass('show')) {\n          elem.addClass('show');\n          isCollapsed = true;\n        }\n        t = $.trim(pre.text());\n        if(isCollapsed && elem.hasClass('show')) {\n          elem.removeClass('show');\n        }\n      } else {\n        t = $.trim(pre.text());\n      }\n      return $.trim(t);\n    }\n\n    /**\n     *\n     * @param {string} url url to resource relative to document root\n     * @returns {string} url + version argument (timestamp of file)\n     */\n    function getStaticImgTag(url = '') {\n      var xhr = $.ajax({\n        url: url,\n        async: false,\n        // success: function(response) {\n        // }\n      });\n      return url+\"?v=\" + Date.parse(xhr.getResponseHeader(\"Last-Modified\"))/1000;\n    }\n  });\n};\n\n"],"names":["each","this","after","btnHtml","prop","addClass","append","tooltip","on","clipboard","ClipboardJS","text","trigger","self","t","pre","target","data","$","trim","prev","attr","get","elem","parent","isCollapsed","hasClass","removeClass","getContent","$cloned","clone","find","remove","end","filter","removeAttr","src","url","xhr","ajax","async","Date","parse","getResponseHeader","getStaticImgTag","e","clearSelection","fallbackMsg","test","navigator","userAgent"],"mappings":"qbAIoB,gCAChB,+BAIE,wEAAwEA,MAAK,+BAG3EC,MAAMC,MAFM,uHAKd,gCAAgCF,MAAK,eACjCG,SAAU,mBAAE,2FACe,SAA5B,mBAAEF,MAAMG,KAAK,YACdD,QAAQE,SAAS,oCACfJ,MAAMC,MAAMC,WAEdA,QAAQE,SAAS,yCACfJ,MAAMK,OAAOH,iCAIjB,eACOI,UACAC,GAAG,cAAc,+BACdP,MAAMM,QAAQ,eAGtBE,UAAY,IAAIC,mBAAY,gBAAiB,CAC/CC,KAAM,SAAUC,aAoCVC,KAnCAC,EAAI,GACJC,IAAM,KAGNC,QAAS,mBAAEJ,SAASK,KAAK,uBACP,IAAZD,aAEc,KADtBA,QAAS,mBAAE,IAAIA,gBAENE,gBAAEC,KAAKH,OAAOL,gBAMH,KADtBK,QAAS,mBAAEJ,SAASQ,OAAOC,KAAK,WAI5BP,GAFFC,KAAM,mBAAEC,OAAS,gBACVM,IAAI,kBA4EGP,2DAAM,KACpBD,EAAI,8BACI,OAARC,WACKD,MAELS,KAAOR,IAAIS,OAAO,aAClBC,aAAc,EACfF,KAAKD,IAAI,IACLC,KAAKG,SAAS,UACjBH,KAAKlB,SAAS,QACdoB,aAAc,GAEhBX,EAAII,gBAAEC,KAAKJ,IAAIJ,QACZc,aAAeF,KAAKG,SAAS,SAC9BH,KAAKI,YAAY,SAGnBb,EAAII,gBAAEC,KAAKJ,IAAIJ,eAEVO,gBAAEC,KAAKL,GA9FJc,CAAWb,KAEXG,gBAAEC,MAAK,mBAAEH,QAAQL,QAGd,KAANG,UACMA,UAMM,KADjBA,GAAI,mBAAEF,SAASQ,OAAOC,KAAK,kBACW,KAANP,SAEvBA,MAMPD,KADuC,SAAtC,mBAAED,SAASQ,OAAOhB,KAAK,YACjB,mBAAEQ,SAASQ,QAEX,mBAAER,SAASY,UAEZF,IAAI,GAAI,KACVO,QAAUhB,KACLiB,QACAC,KAAK,kBACLC,SACAC,MACAN,YAAY,YACZO,OAAO,cACPC,WAAW,YACW,QAA5BN,QAAQzB,KAAK,WAAsB,KAChCgC,IAAMP,QAAQR,KAAK,OACvBQ,QAAQR,KAAK,qBAmEIgB,2DAAM,GACzBC,IAAMpB,gBAAEqB,KAAK,CACfF,IAAKA,IACLG,OAAO,WAIFH,IAAI,MAAQI,KAAKC,MAAMJ,IAAIK,kBAAkB,kBAAkB,IA1E5CC,CAAgBR,SAI7B,MAFTtB,EAAIe,QAAQzB,KAAK,qBAGRU,QAGJ,8BAIXL,UAAUD,GAAG,WAAW,SAAUqC,uBAC9BA,EAAEjC,SACKS,KAAK,QAAS,WACdd,QAAQ,aACRA,QAAQ,QACRc,KAAK,QAAS,qBACdd,QAAQ,aAEjBsC,EAAEC,oBAGJrC,UAAUD,GAAG,SAAS,SAAUqC,OAE1BE,YAAc,UADA,OAAOC,KAAKC,UAAUC,WAAa,IAAW,SACrB,gCAEzCL,EAAEjC,SACKS,KAAK,QAAS0B,aACdxC,QAAQ,aACRA,QAAQ,QACRc,KAAK,QAAS,qBACdd,QAAQ"}